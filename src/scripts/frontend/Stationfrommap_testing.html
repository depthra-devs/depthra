<script>
            let map;
            let markers = [];
            let updateInterval;
            let stationsData = [];

            // Function to generate the HTML for a single station card
            function createStationCard(station) {
                const statusColors = {
                    'Active': 'bg-green-100 text-green-700',
                    'Warning': 'bg-yellow-100 text-yellow-700',
                    'Critical': 'bg-red-100 text-red-700'
                };

                const qualityColors = {
                    'Excellent': 'text-green-500',
                    'Good': 'text-yellow-500',
                    'Fair': 'text-red-500'
                };

                const trendIcon = station.trend === 'up'
                    ? `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4 text-green-500">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 10.5L12 3m0 0l7.5 7.5M12 3v18" />
                       </svg>`
                    : `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4 text-red-500">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 13.5L12 21m0 0l-7.5-7.5M12 21V3" />
                       </svg>`;

                return `
                    <div class="flex flex-col bg-gray-50 border border-gray-200 rounded-xl p-4">
                        <div class="flex items-center justify-between mb-2">
                            <div>
                                <h3 class="font-semibold text-gray-800 text-lg">${station.name} <span class="text-sm px-2 py-0.5 rounded-full ${statusColors[station.status]}">${station.status}</span></h3>
                                <p class="text-sm text-gray-500">${station.id}</p>
                                <p class="text-xs text-gray-400 mt-1">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4 inline-block align-sub mr-1">
                                        <path fill-rule="evenodd" d="M9.261 17.653C10.59 16.126 16.5 10.74 16.5 8a4.5 4.5 0 10-9 0c0 2.74 5.91 8.126 7.239 9.653a.75.75 0 001.022 0zM12 8a1.5 1.5 0 10-3 0 1.5 1.5 0 003 0z" clip-rule="evenodd" />
                                    </svg>
                                    ${station.location}
                                </p>
                            </div>
                            <button class="text-gray-400 hover:text-gray-600">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.575 3.01 9.963 7.822.067.29.067.595 0 .885C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.575-3.01-9.963-7.822z" />
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                </svg>
                            </button>
                        </div>
                        <div class="grid grid-cols-3 gap-2 text-center mt-2">
                            <div class="bg-blue-100 rounded-lg p-3">
                                <p class="font-bold text-lg text-blue-800">${station.waterLevel.toFixed(1)}m</p>
                                <p class="text-xs text-blue-600">Water Level</p>
                            </div>
                            <div class="bg-green-100 rounded-lg p-3">
                                <p class="font-bold text-lg ${qualityColors[station.quality]} flex items-center justify-center space-x-1">
                                    ${trendIcon}
                                    <span>${station.quality}</span>
                                </p>
                                <p class="text-xs text-green-600">Quality</p>
                            </div>
                            <div class="bg-purple-100 rounded-lg p-3">
                                <p class="font-bold text-lg text-purple-800">${station.lastUpdated} min ago</p>
                                <p class="text-xs text-purple-600">Last Update</p>
                            </div>
                        </div>
                    </div>
                `;
            }
